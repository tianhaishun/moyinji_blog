{% extends "base.html" %}

{% block content %}
<div class="min-h-screen bg-paper">
    <!-- Header -->
    <section class="py-12 md:py-16 px-4 md:px-6 border-b border-yaqing/10">
        <div class="max-w-7xl mx-auto">
            <h1 class="text-3xl md:text-4xl lg:text-5xl text-center mb-6 md:mb-8 font-serif">文章</h1>

            <!-- Filters -->
            <div class="flex flex-wrap justify-center gap-2 md:gap-3">
                <a href="{% url 'blog:list' %}" class="tag-song {% if not current_category and not current_tag %}border-hupo text-hupo{% endif %}">
                    全部
                </a>
                {% for category in categories %}
                <a href="?category={{ category.slug }}"
                   class="tag-song {% if current_category == category.slug %}border-hupo text-hupo{% endif %}">
                    {{ category.name }}
                </a>
                {% endfor %}
            </div>

            {% if tags %}
            <div class="flex flex-wrap justify-center gap-2 md:gap-3 mt-3 md:mt-4">
                {% for tag in tags %}
                <a href="?tag={{ tag.slug }}"
                   class="tag-song text-xs md:text-sm {% if current_tag == tag.slug %}border-hupo text-hupo{% endif %}">
                    #{{ tag.name }}
                </a>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </section>

    <!-- Posts Grid -->
    <section class="py-12 md:py-16 px-4 md:px-6">
        <div class="max-w-7xl mx-auto">
            {% if posts %}
            <div class="grid-song">
                {% for post in posts %}
                <article class="card-song overflow-hidden group animate-unfurl {% cycle 'stagger-0' 'stagger-1' 'stagger-2' 'stagger-3' %}">
                    <a href="{{ post.get_absolute_url }}" class="block">
                        {% if post.cover_image %}
                        <div class="zoom-container aspect-[4/3] ink-wash-hover">
                            <img src="{{ post.cover_image.url }}"
                                 alt="{{ post.title }}"
                                 class="w-full h-full object-cover"
                                 loading="lazy">
                        </div>
                        {% else %}
                        <div class="aspect-[4/3] bg-yaqing/10 flex items-center justify-center ink-wash-hover">
                            <span class="text-yaqing/40 text-4xl">墨</span>
                        </div>
                        {% endif %}
                        <div class="p-4 md:p-6">
                            <div class="flex items-center gap-2 md:gap-3 mb-2 md:mb-3">
                                {% if post.category %}
                                <span class="text-xs md:text-sm text-hupo">{{ post.category.name }}</span>
                                {% endif %}
                                <span class="text-xs md:text-sm text-yaqing/40">{{ post.created_at|date:"Y.m.d" }}</span>
                            </div>
                            <h3 class="text-base md:text-xl font-serif text-yaqing mb-2 md:mb-3 group-hover:text-hupo transition-colors">
                                {{ post.title }}
                            </h3>
                            {% if post.excerpt %}
                            <p class="text-sm md:text-base line-clamp-2">{{ post.excerpt }}</p>
                            {% endif %}
                            {% if post.tags.all %}
                            <div class="flex flex-wrap gap-1 md:gap-2 mt-3 md:mt-4">
                                {% for tag in post.tags.all %}
                                <span class="text-xs text-yaqing/50">#{{ tag.name }}</span>
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>
                    </a>
                </article>
                {% endfor %}
            </div>
            {% else %}
            <div class="text-center py-16 md:py-20">
                <p class="text-yaqing/60">暂无文章</p>
            </div>
            {% endif %}
        </div>
    </section>
</div>
{% endblock %}
